{% extends "vbase.html" %}
{% block title %}Home{% endblock %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/mye.css' %}">
<div class="container">
    <h1 class="heading">My Pocket</h1>

    <div class="balance-container">
        <p class="balance-label">Balance</p>
        <p class="balance-amount" id="balanceAmount">₹{{ balance }}</p>
        <br>
        <button class="view-details-btn" onclick="location.href='{% url "vpass" %}'">View Passbook</button>
    </div>
    
    <br>

    <div class="my-earnings-container" onclick="toggleMyEarnings()">
        <h2>My Earnings</h2>
        <br>
        <div class="my-earnings-summary" id="myEarningsSummary">
            <div class="earnings-container today">
                <h3><i class="fas fa-calendar-day"></i> Today's Earnings</h3>
                <p>₹{{ todays_earnings }}</p>
            </div>
            <div class="earnings-container overall">
                <h3><i class="fas fa-money-bill-wave"></i> Overall Earnings</h3>
                <p>₹{{ overall_earnings }}</p>
            </div>
        </div>
    </div>
<!-- 
    <div id="filtersSection">
        <div class="filters-container">
            <div class="filter">
                <label for="time-filter">Filter 1 (Select Time Period):</label>
                <select id="time-filter" onchange="applyFilters()">
                    <option value="">Select</option>
                    <option value="today">Today</option>
                    <option value="yesterday">Yesterday</option>
                    <option value="this-month">This Month</option>
                    <option value="previous-month">Previous Month</option>
                </select>
            </div>
            <div class="filter">
                <label for="from-date">From Date:</label>
                <input type="date" id="from-date" onchange="applyFilters()">
            </div>
            <div class="filter">
                <label for="to-date">To Date:</label>
                <input type="date" id="to-date" onchange="applyFilters()">
            </div>
        </div>
    </div>
-->
    <div id="myEarnings">
        <h3>My Earnings Details</h3>
        <table>
            <thead>
                <tr>
                    <th>Sl no</th>
                    <th>Order ID</th>
                    <th>Date</th>
                    <th>Distance</th>
                    <th>Price</th>
                </tr>
            </thead>
            <tbody id="earnings-body">
                {% for order in orders %}
                    <tr {% if forloop.counter > 10 %}class="hidden-row"{% endif %}>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ order.order_id }}</td>
                        <td>{{ order.date }}</td>
                        <td>{{ order.distance }}</td>
                        <td>{{ order.price }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="5">No earnings details available.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        <button id="loadMoreBtn" onclick="loadMoreRows()">Load More....</button>
    </div>

    <style>
        .hidden-row {
            display: none;
        }
    </style>

<script>
    let visibleRows = 10;

    function loadMoreRows() {
        const rows = document.querySelectorAll('#earnings-body .hidden-row');
        
        // Display the next 10 hidden rows
        for (let i = 0; i < 10 && i < rows.length; i++) {
            rows[i].classList.remove('hidden-row');
        }

        // Hide Load More button if no more hidden rows
        if (document.querySelectorAll('#earnings-body .hidden-row').length === 0) {
            document.getElementById('loadMoreBtn').style.display = 'none';
        }
    }

    function toggleMyEarnings() {
        const earningsSummary = document.getElementById('myEarningsSummary');
        earningsSummary.classList.toggle('hidden');
        document.getElementById('filtersSection').classList.toggle('hidden');
    }

    function applyFilters() {
        // Add your filtering logic here
    }
</script>
{% endblock content %}
