<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver App - Register</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/vregisration.css' %}">
</head>
<body>

   
    <!-- Driver Registration Form -->
    <div class="container" id="register">
        <h1>DRIVER REGISTRATION</h1>

        <!-- Dropdown Menu for Steps (will be hidden on second page) -->
        <div class="dropdown" id="dropdownMenu">
            <button class="dropdown-button" onclick="toggleDropdown()">Steps To Register</button>
            <div class="dropdown-content" id="steps">
                <h2>Steps To REGISTRATION</h2>
                <ol>
                    <li>Fill out the registration form with your details.</li>
                    <li>Upload your profile photo and driving license card photo.</li>
                    <li>Wait for approval from the admin team.</li>
                    <li>Once approved, you will receive a confirmation email to start driving.</li>
                </ol>
            </div>
        </div>
        <form id="signup-form" method="POST" action="{% url 'vreg' %}">
            {% csrf_token %}
            
            <div id="status-message"></div>
            
            <!-- Step 1: Personal Details -->
            <div id="step1" class="show">
                <label for="firstName">First Name:</label>
                <input type="text" id="firstName" name="firstName" placeholder="Enter your first name" required>
        
                <label for="lastName">Last Name:</label>
                <input type="text" id="lastName" name="lastName" placeholder="Enter your last name" required>
        
                <label for="phonenumber">Phone Number:</label>
                <input type="text" id="phonenumber" name="phonenumber" placeholder="Enter your phone number" required>
        
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="Enter your email" required>
        
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" placeholder="Enter your password" required>
        
                <label for="confirmPassword">Confirm Password:</label>
                <div class="password-container">
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
                    <i class="fas fa-eye" id="togglePassword" onclick="togglePasswordVisibility()"></i>
                </div>
        
                <button type="submit">Register</button>
                <p class="login-link">Already have an account? <a href="{% url 'vlogin' %}">Login Here</a></p>
                
                <!-- Separator Line -->
                <div class="separator"></div>
                
                <!-- Social Login Buttons -->
                <div class="social-login">
                    <button class="facebook-login">
                        <i class="fab fa-facebook-f"></i> Login with Facebook
                    </button>
                    <button class="google-login">
                        <i class="fab fa-google"></i> Login with Google
                    </button>
                </div>
            </div>
        </form>


    <script>
        document.getElementById('signup-form').addEventListener('submit', function(event) {
            event.preventDefault();  // Prevent form from submitting the traditional way

            const formData = new FormData(this);
            const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;

            fetch("{% url 'vreg' %}", {
                method: "POST",
                body: formData,
                headers: {
                    "X-CSRFToken": csrfToken,
                }
            })
            .then(response => response.json())
            .then(data => {
                const statusMessage = document.getElementById('status-message');
                statusMessage.innerHTML = '';  // Clear previous messages

                if (data.error) {
                    statusMessage.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
                } else if (data.success) {
                    statusMessage.innerHTML = `<div class="alert alert-success">${data.success}</div>`;
                    // Optionally, redirect to login page after success
                    window.location.href = "{% url 'driver_reg' %}";
                }
            })
            .catch(error => console.error('Error:', error));
        });
        function toggleDropdown() {
            var dropdownContent = document.getElementById('steps');
            if (dropdownContent.style.display === 'block') {
                dropdownContent.style.display = 'none';
            } else {
                dropdownContent.style.display = 'block';
            }
        }


        function toggleMenu() {
            var menu = document.querySelector('.menu');
            if (menu.style.display === 'flex') {
                menu.style.display = 'none';
            } else {
                menu.style.display = 'flex';
            }
        }

        function togglePasswordVisibility() {
            var passwordField = document.getElementById('confirmPassword');
            var passwordIcon = document.getElementById('togglePassword');
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                passwordIcon.classList.remove('fa-eye');
                passwordIcon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                passwordIcon.classList.remove('fa-eye-slash');
                passwordIcon.classList.add('fa-eye');
            }
        }

        // Hide the steps dropdown
        function hideSteps() {
            document.getElementById('dropdownMenu').style.display = 'none';
        }

        // Show the steps dropdown
        function showSteps() {
            document.getElementById('dropdownMenu').style.display = 'block';
        }
        
    </script>
</body>
</html>